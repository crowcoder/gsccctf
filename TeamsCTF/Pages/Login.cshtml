@page
@model TeamsCTF.Pages.LoginModel
<h1>Login</h1>
<button onclick="return login();">Log In</button>
<script>

    window.addEventListener('load', (evt) => {
        microsoftTeams.initialize();
    });

    function login() {
        microsoftTeams.authentication.authenticate({
            url: window.location.origin + "/auth-start",
            width: 600,
            height: 535,
            successCallback: function (result) {
                alert(result.accessToken);
                //getUserProfile(result.accessToken);
            },
            failureCallback: function (reason) {
                alert(reason);
            }
        });
    }

</script>